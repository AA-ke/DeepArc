# DNABERT-2: EFFICIENT FOUNDATION MODEL AND BENCHMARK FOR MULTI-SPECIES GENOMES

Zhihan Zhou† Yanrong Ji† Weijian Li† Pratik Dutta‡ Ramana V Davuluri‡ Han Liu†

† Department of Computer Science, Northwestern University, Evanston, IL, USA

$\ddagger$  Department of Biomedical Informatics, Stony Brook University, Stony Brook, NY, USA

{zhihanzhou, yanrongji, weijianli}@u.northwestern.edu

pratik.dutta@stonybrook.edu, Ramana.Davuluri@stonybrookmedicine.edu

hanliu@northwestern.edu

# ABSTRACT

Decoding the linguistic intricacies of the genome is a crucial problem in biology, and pre-trained foundational models such as DNABERT and Nucleotide Transformer have made significant strides in this area. Existing works have largely hinged on  $k$ -mer, fixed-length permutations of A, T, C, and G, as the token of the genome language due to its simplicity. However, we argue that the computation and sample inefficiencies introduced by k-mer tokenization are primary obstacles in developing large genome foundational models. We provide conceptual and empirical insights into genome tokenization, building on which we propose to replace k-mer tokenization with Byte Pair Encoding (BPE), a statistics-based data compression algorithm that constructs tokens by iteratively merging the most frequent co-occurring genome segment in the corpus. We demonstrate that BPE not only overcomes the limitations of k-mer tokenization but also benefits from the computational efficiency of non-overlapping tokenization. Based on these insights, we introduce DNABERT-2, a refined genome foundation model that adapts an efficient tokenizer and employs multiple strategies to overcome input length constraints, reduce time and memory expenditure, and enhance model capability. Furthermore, we identify the absence of a comprehensive and standardized benchmark for genome understanding as another significant impediment to fair comparative analysis. In response, we propose the Genome Understanding Evaluation, a comprehensive multi-species genome classification dataset that amalgamates 36 distinct datasets across 9 tasks, with input lengths ranging from 70 to 10000. Through comprehensive experiments on the GUE benchmark, we demonstrate that DNABERT-2 achieves comparable performance to the state-of-the-art model with  $21 \times$  fewer parameters and approximately  $92 \times$  less GPU time in pre-training. Compared to DNABERT, while being  $3 \times$  more efficient, DNABERT-2 outperforms it on 23 out of 28 datasets, with an average improvement of 6 absolute scores on GUE. The code, data, and pre-trained model are available at https://github.com/MAGICS-LAB/DNABERT_2.

# 1 INTRODUCTION

Transformer-based foundation models (Bommasani et al., 2022; Kenton & Toutanova, 2019; OpenAI, 2023) have witnessed significant progress in recent years, particularly exemplified by the advent of groundbreaking language models like ChatGPT (Ouyang et al., 2022; OpenAI, 2023). In parallel, the significance of foundation models has also been increasingly appreciated in the genomics field, as they represent the understanding of genome sequences via numerical embeddings that are directly applicable to various genome analysis tasks. These models can capture complex relationships and dependencies in DNA sequences, opening new avenues for understanding transcriptional regulation (Li et al., 2023), non-coding genetic variants associated with human diseases and traits (Rozowsky et al., 2023), and the functional effects of regulatory elements (Smith et al., 2023). Recent advancements in genome language modeling have demonstrated their superiority in a range of downstream applications, including promoter prediction (Le et al., 2022; Zhang et al., 2022), gene expression

prediction (Avsec et al., 2021), DNA methylation prediction (Jin et al., 2022), chromatin state analysis (Lee et al., 2022), promoter-enhancer interaction prediction (Chen et al., 2022; Ni et al., 2022), TF-DNA binding prediction (Wang et al., 2022), variant effect prediction (Rozowsky et al., 2023), gene network prediction (Theodoris et al., 2023) and more. These models provide researchers with powerful tools to understand the functional importance of different genomics elements and unravel key biological processes and mechanisms.

In this context, Ji et al. (2021) developed DNABERT, an initial foundation model (FM), to unravel the human genome from a language perspective. Despite being widely applied in the community, several technical limitations still present at the time with the original DNABERT implementation, limiting its full potential. First, although proven to be generalizable to other organisms, the pretraining was solely done on the human reference genome, omitting the sequence conservation and diversity across species. Second, k-mer tokenization resulted in information leakage and overall poor computational efficiency during pre-training, which hampers its scalability. Lastly, the simplistic DNABERT-XL solution—intended to bypass the restriction of 512 input sequences imposed by the learned positional embedding (Kenton & Toutanova, 2019)—fell short in handling long input sequences, both in efficiency and effectiveness. These limitations underlined the need for further advancements in the domain of DNA language models.

Recently, Dalla-Torre et al. (2023) introduced Nucleotide Transformers (NT), a series of genome foundation models scaling from  $500M$  to  $2500M$  parameters. NT alleviated the first two limitations of DNABERT by pre-training on a large collection of genomes from 850 species and replacing overlapping k-mer tokenization with a non-overlapping version, substantially reducing tokenized sequence length. Despite this, a hard input length limitation still exist, while, as we will discuss in Sec. 2, non-overlapping k-mer tokenization also suffered from poor sample efficiency as it complicates the model's task of aligning significantly distinct representations of near-identical inputs.

In view of the aforementioned limitations, we introduce DNABERT-2, a multi-species genome foundation model that replaces k-mer tokenization with Byte Pair Encoding (BPE) (Sennrich et al., 2016), a data compression algorithm that has been widely used by large language models. We show that BPE effectively addresses the known issues of k-mer tokenization while maintaining the computational efficiency of non-overlapping tokenization. Moreover, DNABERT-2 overcomes the limitation of DNABERT by replacing learned positional embeddings with Attention with Linear Biases (ALiBi) (Press et al., 2021) to get rid of the input length limitation, incorporating Flash Attention (Dao et al., 2022) to increase computational efficiency, and adjusting model architecture to increase model capability. As a result of the efficient tokenizer and advanced model architecture, DNABERT-2 achieves comparable performance to the state-of-the-art model with approximately  $92 \times$  less computational cost and  $21 \times$  fewer parameters, identifying its computation- and sample-efficiency and enabling efficient fine-tuning on most consumer GPUs.

Meanwhile, despite progress in genome foundational models, the absence of carefully curated benchmarks has posed a significant challenge. Owing to the unstandardized pre-processing pipeline of genome sequences, it is unjust to directly compare model performances with results reported in previous papers, even when the data originate from the same source. Moreover, many genome understanding evaluation datasets used in existing works (Dalla-Torre et al., 2023) are either too trivial or too challenging, leading to similar scores for most models and failing to accurately reflect different models' capabilities. The scarcity of high-quality benchmark datasets hampers evaluating and comparing different models and further hinders the development of novel techniques. To this end, we introduce Genome Understanding Evaluation (GUE & GUE $^+$ ), a standardized and comprehensive multi-species benchmark containing 36 datasets across 9 important genome analysis tasks on genomes of 4 species with input lengths ranging from 70 to 10000. All the datasets are elaborately calibrated with a series of strategies to ensure they are suitable for reflecting the capability level of existing genome foundation models.

Our main contributions can be therefore summarized as follows: 1) We identify key obstacles in genome tokenization and provide deep insights, presenting a simple yet effective solution that balances the efficiency and effectiveness of genome foundation models; 2) We introduce DNABERT-2, an efficient pre-trained foundation model for multi-species genome that delivers performance on par with the state-of-the-art model while being  $21 \times$  smaller and utilizes approximately  $92 \times$  less GPU time; 3) We introduce Genome Understanding Evaluation (GUE), a standardized, comprehensive,

![image](https://cdn-mineru.openxlab.org.cn/result/2026-01-06/c0146663-5f32-4da2-9cb4-7cae485d55bb/49ce2f806c24d9e545a7d96df19c4fe3b1c165f3ed91b96a5d24fbe520febad0.jpg)



Figure 1: Illustration of the drawbacks of k-mer tokenization. In the overlapping setting, information about a masked token is leaked by its adjacent tokens, while in the non-overlapping setting, adding/deleting one nucleotide base leads to a dramatic change in the tokenized sequence.


and well-calibrated multi-species genome classification benchmark including 9 tasks and 36 datasets to facilitate research in genome foundation model.

# 2 BACKGROUND

Tokenization serves as a critical initial step in language modeling, significantly impacting the efficiency and effectiveness of the model. DNA sequences consist of 4 unique nucleotide bases: A, T, C, and G. A majority of genome language models (Ji et al., 2021; Dalla-Torre et al., 2023) utilize the k-mer tokenization technique, in which each contiguous  $k$ -length genome segment is considered as a token. During tokenization, a sliding window with window size  $k$  and stride  $t$  is employed to convert the original genome sequence into a series of k-mers. Here, the stride  $t$  is either set as 1 or  $k$ , while the first one represents the overlapping version of k-mer tokenization and the other one represents the non-overlapping version. Figure 1 presents examples of overlapping (left) and non-overlapping (right) k-mer tokenizations. Despite its wide application, we argue that both versions of the k-mer tokenization are less optimal.

Overlapping k-mers tokenization ensures adjacent tokens always overlap by  $k - 1$  characters, resulting in significant information leakage in masked language modeling. As depicted in Figure 1, a masked token is entirely leaked when adjacent tokens from both sides are not masked, and it is partially leaked when adjacent tokens from only one side are present. Generally, in the overlapping  $k$ -mer tokenization setting, let  $l$  and  $r$  denote the distances between a masked token [M] and its closest unmasked adjacent token on the left and right sides, the number of possible options of [M] is  $4^{\min(l, r, k, \max(0, l + r - k))}$ . In other words, to prevent the entire leakage of a masked token, at least  $k - 1$  tokens on its left and right sides in total must be masked, which explains why Ji et al. (2021) opt to mask a continuous span of  $k$  tokens. Furthermore, to guarantee no leakage of a masked token, at least  $k$  tokens on both sides must be masked. Nevertheless, information leakage is still inevitable for the leftmost and rightmost  $k - 1$  masked tokens. Ideally, in masked language modeling, a model is required to select the best option from the entire vocabulary, enabling it to differentiate and evaluate among a large number of options. However, if the search space is undesirably reduced due to information leakage, the model only needs to differentiate between a limited number of options. Consequently, this results in poor sample efficiency, as the model may not be sufficiently challenged to learn the underlying patterns in the data. Also, the tokenized sequence for an input of length  $L$  consists of  $L - k + 1$  tokens, each with a length of  $k$ . This results in a tokenized sequence with considerable redundancy and a length nearly equivalent to the original sequence, leading to low computation efficiency considering the quadratic computation complexity of Transformer-based (Vaswani et al., 2017) models. This becomes particularly problematic when attempting to scale up the model. Therefore, Dalla-Torre et al. (2023) proposed the non-overlapping k-mer tokenization.

Non-overlapping k-mer tokenization, despite its advantage of reducing sequence length by a factor of  $k$ , is plagued by a notable issue of sample inefficiency. Figure 1 graphically illustrates this problem. Considering a scenario when the context window is reduced by 1, the model input is then switched from Sequence 1 to Sequence 2. In theory, this should involve a minor adjustment in tokenized output. However, with the non-overlapping k-mer tokenizer, this minor shift instigates a dramatic alteration in the tokenized output. Despite the two sequences originating from the same genomic segment, their tokenized representations bear little resemblance. This inconsistent behavior introduces

unnecessary hurdles for the model during training, as it poses unnecessary difficulty for the model to align distinct representations of identical or near-identical inputs. Consequently, the inefficiency in learning from the data could impede the overall model performance. The implications of these observations advocate for a re-evaluation of tokenization strategies for the genome language, with a focus on strategies that ensure robust and efficient representation.

To address the aforementioned issues, we propose to adapt SentencePiece (Kudo & Richardson, 2018), a subword tokenization framework widely used in natural language processing, to replace k-mer tokenization for genome sequences. We employ Byte-Pair Encoding (BPE) (Sennrich et al., 2016) to iteratively merge frequent pairs of nucleotides and genome segments, forming a vocabulary of variable-length tokens that effectively represent the entire genome dataset. Despite its conceptual simplicity, this method is well-suited for genome foundation models. First, it not only prevents information leakage but also significantly reduces the sequence length by approximately 5 times (detailed statistics are presented in Sec 3.1), substantially improving computational efficiency. Moreover, its robust tokenization result is beneficial for sample efficiency since it allows the model to focus on understanding the genome language semantics without being distracted by the distinct representations of the same input. Furthermore, unlike k-mer tokenization, BPE doesn't always produce tokens of length  $k$ . Consequently, when a token containing an unspecified number of nucleotides is masked, the model is challenged to predict both the number of nucleotides and the particular nucleotides themselves. This naturally transforms the masked language modeling objective into a T5-style (Raffel et al., 2020) "replace spans of text" objective, which has been demonstrated to be more effective than standard masked language modeling in various scenarios.

# 3 METHOD

In this section, we provide empirical analysis on the BPE tokenizer for genome language (§ 3.1) and describe the model architecture (§ 3.2) and implementation details (§ A.2) of DNABERT-2.

# 3.1TOKENIZER

<table><tr><td>Iteration</td><td>Corpus</td><td>Vocabulary</td></tr><tr><td>0</td><td>AACGCACTATATA</td><td>{A,T,C,G}</td></tr><tr><td>1</td><td>A A C G C A C T A T A T A</td><td>{A,T,C,G,TA}</td></tr><tr><td>2</td><td>A A C G C A C T A T A T A</td><td>{A,T,C,G,TA,AC}</td></tr><tr><td>3</td><td>A A C G C A C T A T A T A</td><td>......</td></tr></table>

Figure 2: Illustration of the BPE vocabulary constructions.

DNABERT-2 adapts SentencePiece (Kudo & Richardson, 2018) with Byte Pair Encoding (BPE) (Sennrich et al., 2016) to perform tokenization for DNA sequences. SentencePiece is a language-agnostic tokenizer that considers each input as a raw stream without assuming any pre-tokenization, which matches greatly with genome sequences where the definitions of word and sentence do not exist. BPE is a compression algorithm that has been widely used in the area

of natural language processing as a word segmentation strategy. It learns a fixed-sized vocabulary of variable-length tokens based on the co-occurrence frequency of the characters. Figure 2 illustrates the process of constructing a vocabulary from a given corpus with BPE. First, we initialize the vocabulary with all unique characters in the corpus. Then, in each iteration, we view the most frequent character segment (e.g., TA at iteration 1) as a new word, add it to the vocabulary, and update the corpus by replacing all the same segments with this new word. The iteration continues till we achieve the desired number of words in the vocabulary. Thus, the target vocabulary size plays a crucial role.

Due to the significant difference between natural language and DNA sequence, vocabulary sizes that are commonly used in the NLP area (Kenton & Toutanova, 2019; Vaswani et al., 2017; Raffel et al., 2020; OpenAI, 2023) may not be appropriate for genome sequences. To determine the most suitable vocabulary size, we constructed 8 vocabularies with target sizes ranging from  $2^{8}$  to  $2^{15}$  on the multi-species genomes (see Sec. 4.1) to empirically evaluate the impact of varying vocabulary sizes. As indicated in Figure 3a, larger vocabularies tend to encompass more lengthy tokens, which enables the tokenizer to represent the same input sequence with fewer tokens. Shorter tokenized sequences consequently reduce the computational cost (See Figure 3b), as the computational complexity of Transformers is quadratic in relation to the input sequence length. Therefore, from the computation efficiency perspective, a larger vocabulary size is favorable.

![image](https://cdn-mineru.openxlab.org.cn/result/2026-01-06/c0146663-5f32-4da2-9cb4-7cae485d55bb/8c574fee92c654b1c8fa8abbb6d794387b60419e8b8f418e2951f46a19504066.jpg)



(a) Average token length and the length ratio of original sequence v.s. tokenized sequence.


![image](https://cdn-mineru.openxlab.org.cn/result/2026-01-06/c0146663-5f32-4da2-9cb4-7cae485d55bb/88bbb231cf326d66d55e04326936de538e4c5bce5bd28032b48de769d516c79b.jpg)



(b) Training FLOPs on 500-length sequences compared to model with  $2^{8}$  vocabulary.


![image](https://cdn-mineru.openxlab.org.cn/result/2026-01-06/c0146663-5f32-4da2-9cb4-7cae485d55bb/42372277e3497d1d44aa946d97a5403267f318582f6599bf52a3c14da89649dc.jpg)



(c) Model performance averaged over each tasks (macro) and individual dataset (micro).



Figure 3: This figure presents the average token length, average sequence length reduced after tokenization, and model performance on the GUE benchmark with different vocabulary sizes.


However, a larger vocabulary leads to more sparse updates to the embedding layer, given that each token would be used less frequently, which might compromise the model's performance. We empirically analyzed this issue by pre-training three different DNABERT-2 variants with vocabulary sizes of  $2^{8}$ ,  $2^{12}$ , and  $2^{15}$  on the multi-species genome dataset with a batch size of 2048 for 150000 steps and evaluating them on the GUE benchmark (see Sec. 4.2). Figure 3c displays the performance of each variant, where the model performance is measured by the dataset- and task-average scores. As depicted in the figure, unlike computational efficiency, the model's performance does not consistently improve as the vocabulary size increases. Therefore, we selected a vocabulary size of  $2^{12} = 4096$  for training the final DNABERT-2 model, as it best balances model performance with computational efficiency among the candidates.

# 3.2 MODEL

DNABERT-2 adapts the Transformer Encoder architecture. To address the limitations of existing models, we incorporate a series of recent advances in deep learning to increase the model's efficiency and capability, including: 1) replacing learned positional embeddings with the Attention with Linear Biases (ALiBi) (Press et al., 2021) to overcome the input length limitation; 2) utilizing FlashAttention (Dao et al., 2022) and Low Precision Layer Normalization to increase computation and memory efficiency; 3) employing the Low-Rank Adaptation (LoRA) (Hu et al., 2021) in the fine-tuning stage (if necessary) for parameter-efficient training.

Attention with Linear Biases. Due to the permutation-invariant nature of the attention mechanism, explicit positional information is required in attention-based models. Existing solutions such as Sinusoidal (Vaswani et al., 2017), learned (Kenton & Toutanova, 2019), and Rotary (Su et al., 2021) positional embedding methods either suffer from input length restriction or poor extrapolation capability when applied to sequences longer than training data. Attention with Linear Biases (ALiBi) provides an efficient yet effective solution. Instead of adding position embeddings to the input, ALiBi adds a fixed set of static, non-learned biases to each attention calculation to incorporate positional information into attention scores. Specifically, let  $\mathbf{q}_i$  define the  $i$ -th query in the input sequence of length  $L$  and  $\mathbf{K}$  defines the key matrix, the attention score of query  $i$  is calculated as:  $\text{softmax}(\mathbf{q}_i\mathbf{K} + m*[-(i - 1),\dots, - 2, - 1,0, - 1, - 2,\dots, - (L - 1 - i)]}$ , where  $m$  is a fixed head-specific constant. ALiBi used a geometric sequence (i.e.,  $\frac{1}{2^1},\frac{1}{2^2},\dots,\frac{1}{2^n}$ ) of different  $m$  to each attention head. Intuitively, ALiBi increasingly penalizes attention scores between key-query pairs as their distances increase, and  $m$  determines the penalty rate. Replacing learned position embedding with ALiBi allows DNABERT-2 to effectively handle arbitrarily long sequences during fine-tuning and inference despite being pre-trained on relatively short sequences.

Flash Attention. Flash attention is an IO-aware algorithm that implements the exact standard attention calculation in a more time- and memory-efficient way. It identifies a main bottleneck of standard attention implementation as the lack of taking the number of reads and writes to fast GPU on-chip SRAM and relatively slow GPU high bandwidth memory (HBM) into account. To avoid reading and writing to the slow HBM, it splits Key/Query/Value matrices into blocks and incrementally performs softmax over the entire input. It also proposes to recompute large intermediate results like attention scores in backward pass to trade extra computation for fewer IO with HBM, which empirically leads to less computational time without sacrificing model performance.

Low-Rank Adaptation (LoRA). Fine-tuning all the parameters of a model becomes increasingly expensive as the pre-trained model becomes much larger. Thus, we adopt LoRA, a parameter-efficient fine-tuning method that significantly reduces the computation and memory costs with ignorable performance sacrifice. Let  $W_0, W_1 \in \mathbb{R}^{m \times n}$  define the same weight matrix before and after task-specific fine-tuning, and we have  $W_1 = W_0 + \Delta W$ , where  $\Delta W \in \mathbb{R}^{m \times n}$  represents the change of each weight element during the fine-tuning. In ordinary fine-tuning, we independently update each weight based on its corresponding gradient, while in LoRA, we represent  $\Delta W$  with a low-rank decomposition  $\Delta W = BA$ , where  $B \in \mathbb{R}^{m \times r}$ ,  $A \in \mathbb{R}^{r \times n}$ , and  $r \ll m, r \ll n$ . Modeling  $\Delta W$  with low-rank decomposition reduces the number of trainable parameters from  $m \times n$  to  $r \times (m + n)$ , leading to significant improvement in training time and memory usage.

Besides, we replace the Relu activation function with GEGLU (Shazeer, 2020), a variant of GLU (Dauphin et al., 2017) that has been shown to improve the performance of Transformer models. The GEGLU function is calculated as  $\mathrm{GEGLU}(x,W,V,b,c) = \mathrm{GELU}(xW + b)\otimes (xV + c)$ , where  $x$  is the function input,  $W$  and  $V$  are learnable weights, and  $b$  and  $c$  are learnable biases. The GELU function is defined as  $\mathrm{GELU}(x) = x\Phi (x)$ , where  $\Phi (x)$  is the cumulative distribution function (CDF) of the standard normal distribution.

# 4 DATA

In order to facilitate further research on large-scale genome foundational models, we have collated and made available multi-species genome datasets for both pre-training of models (Sec. 4.1) and benchmarking (Sec. 4.2).

# 4.1 PRE-TRAIN: HUMAN AND MULTI-SPECIES GENOME

To investigate the impact of species diversity on genome foundation models, we compile and made publicly available two datasets for foundation model pre-training: the human genome and the multi-species genome. The human genome dataset is the one used in DNABERT (Ji et al., 2021), which comprises 2.75B nucleotide bases. The multi-species genome dataset encompasses genomes from 135 species, spread across 6 categories. In total, this dataset includes 32.49B nucleotide bases, nearly 12 times the volume of the human genome dataset. We exclude all sequences with N and retain only sequences that consist of A, T, C, and G. Detailed statistics are presented in Table 11.

# 4.2 BENCKMARK: GENOME UNDERSTANDING EVALUATION (GUE & GUE $^{+}$ )

We introduce a large benchmark for genome foundation models. Due to the input length limits of existing genome foundation models, we split the benchmark into two parts: GUE and  $\mathrm{GUE}^{+}$ . GUE (See Table 1) includes 7 genome sequence classification problems with 28 datasets with input lengths ranging from 70 to 1000.  $\mathrm{GUE}^{+}$  (See Table 2), on the other hand, focuses on relatively longer input sequences, rating from 5000 to 10000. To evaluate the multi-species transferability in genome understanding of each model, this benchmarks contains tasks for various species, including human, fungi, virus, and yeast. We explicitly define evaluation metrics for each task and split each dataset into training, validation, and test data for a fair comparison across different models.

To calibrate the benchmark's difficulty level and better illuminate each model's capabilities, we carefully selected datasets that are neither too simple nor overly challenging for current models. For example, when the Nucleotide Transformer variants (Dalla-Torre et al., 2023) were tested on the Splice Site Prediction dataset, all variants achieved an accuracy between  $97\%$  and  $98\%$ . Similar

<table><tr><td>Species</td><td>Task</td><td>Num. Datasets</td><td>Num. Classes</td><td>Sequence Length</td></tr><tr><td rowspan="4">Human</td><td>Core Promoter Detection</td><td>3</td><td>2</td><td>70</td></tr><tr><td>Transcription Factor Prediction</td><td>5</td><td>2</td><td>100</td></tr><tr><td>Promoter Detection</td><td>3</td><td>2</td><td>300</td></tr><tr><td>Splice Site Detection</td><td>1</td><td>3</td><td>400</td></tr><tr><td>Mouse</td><td>Transcription Factor Prediction</td><td>5</td><td>2</td><td>100</td></tr><tr><td>Yeast</td><td>Epigenetic Marks Prediction</td><td>10</td><td>2</td><td>500</td></tr><tr><td>Virus</td><td>Covid Variant Classification</td><td>1</td><td>9</td><td>1000</td></tr></table>


Table 1: Summarization of the Genome Understanding Evaluation (GUE) benchmark.


<table><tr><td>Species</td><td>Task</td><td>Num. Datasets</td><td>Num. Classes</td><td>Sequence Length</td></tr><tr><td>Human</td><td>Enhancer Promoter Interaction</td><td>6</td><td>2</td><td>5000</td></tr><tr><td>Fungi</td><td>Species Classification</td><td>1</td><td>25</td><td>5000</td></tr><tr><td>Virus</td><td>Species Classification</td><td>1</td><td>20</td><td>10000</td></tr></table>

Table 2: Summarization of the Genome Understanding Evaluation Plus (GUE  ${}^{ + }$  ) benchmark.

outcomes were observed in tasks like Promoter Prediction and Enhancer Prediction. These high scores might suggest these variants perform similarly, but as our experiments in Section 5 show, they vary significantly on more discerning datasets.

The construction of the benchmark starts with the aggregation of various biologically important genome analysis datasets, followed by the assessment of existing models such as DNABERT (Ji et al., 2021) and Nucleotide Transformer (Dalla-Torre et al., 2023) on these datasets. Datasets where the majority of models yielded moderate (e.g., F1-scores between 0.3 and 0.8) and distinguishable performance scores were retained. On the other hand, datasets that did not meet these criteria underwent a restructuring process involving various strategies such as class balancing, adversarial sample inclusion, and reduction of training sample volume, among others. After several iterations of this process, we ultimately arrived at 36 representative datasets of moderate difficulty. Due to space limits, we present the detailed data processing and statistics of each dataset in Sec. B.2.

# 5 EXPERIMENTS

We evaluate DNABERT-2 using the proposed benchmark to thoroughly investigate its versatility and robustness across a variety of tasks involving multi-species genomes.

# 5.1 BASELINE

We compare DNABERT-2 with two state-of-the-art genome foundation models: DNABERT (Ji et al., 2021) and Nucleotide Transformer (Dalla-Torre et al., 2023).

DNABERT was the first pre-trained foundational model for genome sequences, trained on human genome sequences. It has four variants, namely DNABERT (3-mer), DNABERT (4-mer), DNABERT (5-mer), and DNABERT (6-mer), which utilize overlapping  $3/4/5/6$ -kmer tokenization respectively. While DNABERT employs the same architecture as BERT-base, it has a different vocabulary size, which is dependent on the chosen  $k$ -mer.

Nucleotide Transformer (NT) scales up the data and model size to achieve state-of-the-art performance in 27 DNA analysis tasks. It also has 4 variants: NT-500M-human, NT-500M-1000g, NT-2500M-1000g, and NT-2500M-multi, where human, 1000g, and multi respectively refers to the GRCh38/hg38 human reference genome, 3202 high-coverage human genomes from the 1000 Genome project (Byrska-Bishop et al., 2021), and genome from 850 different species.

It is important to note that NT models are 6 to 29 times larger than DNABERT, which precludes standard model fine-tuning on consumer GPUs. Therefore, we perform standard fine-tuning for

<table><tr><td>Model</td><td>Params. ↓</td><td>FLOPs ↓</td><td>Trn. Tokens</td><td>Num. Top-2 ↑</td><td>Ave. Scores ↑</td></tr><tr><td>DNABERT (3-mer)</td><td>86M</td><td>3.27</td><td>122B</td><td>2 || 0</td><td>61.62</td></tr><tr><td>DNABERT (4-mer)</td><td>86M</td><td>3.26</td><td>122B</td><td>0 || 1</td><td>61.14</td></tr><tr><td>DNABERT (5-mer)</td><td>87M</td><td>3.26</td><td>122B</td><td>0 || 1</td><td>60.05</td></tr><tr><td>DNABERT (6-mer)</td><td>89M</td><td>3.25</td><td>122B</td><td>0 || 1</td><td>60.51</td></tr><tr><td>NT-500M-human</td><td>480M</td><td>3.19</td><td>50B</td><td>0 || 0</td><td>55.43</td></tr><tr><td>NT-500M-1000g</td><td>480M</td><td>3.19</td><td>50B</td><td>0 || 1</td><td>58.23</td></tr><tr><td>NT-2500M-1000g</td><td>2537M</td><td>19.44</td><td>300B</td><td>0 || 1</td><td>61.41</td></tr><tr><td>NT-2500M-multi</td><td>2537M</td><td>19.44</td><td>300B</td><td>7 || 9</td><td>66.93</td></tr><tr><td>DNABERT-2</td><td>117M</td><td>1.00</td><td>262B</td><td>8 || 4</td><td>66.80</td></tr><tr><td>DNABERT-2♦</td><td>117M</td><td>1.00</td><td>263B</td><td>11 || 10</td><td>67.77</td></tr></table>

Table 3: The statistics and performance of each model. The five columns represent the number of model parameters, relative FLOPs compared to DNABERT-2, the number of tokens used in pre-training, and the number of being top-2 among all the models (1st || 2nd) and the average evaluation scores on the 28 datasets of the GUE benchmark.  $\spadesuit$ : perform further masked language modeling pre-training on the training sets of the GUE benchmark.

DNABERT and DNABERT-2, while adapting the Low-Rank Adaptation (LoRA) technique for fine-tuning the Nucleotide Transformer to enhance efficiency. For a fair comparison, we conducted preliminary experiments to confirm that our implementation of NT achieves comparable results to those reported in their original paper (Dalla-Torre et al., 2023) (see Appendix A.4 for more details).

# 5.2 SETUP AND METRIC

We evaluate the models from two perspectives: computational efficiency and performance on downstream tasks. To measure each model's computational cost, we consider the number of model parameters and the relative Floating Point Operations (FLOPs)—which is the total number of multiplication and addition operations during a forward pass—compared to DNABERT-2. We evaluate FLOPs on genome sequences with a length of 500, a commonly used setup in genome analysis. To measure model performance, we utilize F1-Score and Matthews Correlation Coefficient (MCC). We use different metrics for different tasks, following conventional practices (refer to Table 12 for details). Table 3 presents the overall performance of each model on the GUE benchmark. It provides the average score of each model and the number of times it ranks in the top two among all models. The average results across all tasks are reported in Table 4, while task-specific results are presented in Table 6 due to space constraints. We also include statistics on the number of tokens each model processed during its pre-training phase, providing insight into the effects of training steps on model performance. For each model, we keep most of the hyperparameters (e.g., learning rate, batch size, weight decay, etc.) constant across all datasets, adjusting only the maximum sequence length and the number of training steps according to the specific dataset. Hyperparameter tuning tailored to each dataset is left for future work. Throughout the training process, we validate the model every 200 steps, save the model that yields the smallest loss on the validation set, and report its evaluation results on the test set. We train each model using three different random seeds and report the average results.

Further Pre-Training. We also investigate the impact of additional in-domain pre-training on DNA language models. We combine the training sets of the 28 GUE datasets and further pre-train DNABERT-2 on this combined set. Following Sun et al. (2020), we train the model with a batch size of 32, a maximum sequence length of 128, and a learning rate of  $5e - 5$  for 100,000 steps. This results in 0.41B training tokens, which only constitute  $0.08\%$  of the tokens processed during the entire training process of DNABERT-2.

# 5.3 RESULTS ON GUE

Table 3 outlines the statistics and aggregate performance of the models. As indicated in the table, despite being  $21 \times$  smaller and requiring  $19 \times$  fewer FLOPs, DNABERT-2 delivers a performance comparable to the state-of-the-art model while significantly surpassing other baselines. When DNABERT-2 undergoes additional pre-training on the GUE benchmark, which requires negligible computational overhead, it delivers the highest average performance and consistently ranks in the

<table><tr><td>Species</td><td>Yeast</td><td>Mouse</td><td>Virus</td><td colspan="4">Human</td></tr><tr><td>Task</td><td>EMP</td><td>TF-M</td><td>CVC</td><td>TF-H</td><td>PD</td><td>CPD</td><td>SSP</td></tr><tr><td>DNABERT (3-mer)</td><td>49.54</td><td>57.73</td><td>62.23</td><td>64.43</td><td>84.63</td><td>72.96</td><td>84.14</td></tr><tr><td>DNABERT (4-mer)</td><td>48.59</td><td>59.58</td><td>59.87</td><td>64.41</td><td>82.99</td><td>71.10</td><td>84.05</td></tr><tr><td>DNABERT (5-mer)</td><td>48.62</td><td>54.85</td><td>63.64</td><td>50.46</td><td>84.04</td><td>72.03</td><td>84.02</td></tr><tr><td>DNABERT (6-mer)</td><td>49.10</td><td>56.43</td><td>55.50</td><td>64.17</td><td>81.70</td><td>71.81</td><td>84.07</td></tr><tr><td>NT-500M-human</td><td>45.35</td><td>45.24</td><td>57.13</td><td>50.82</td><td>85.51</td><td>66.54</td><td>79.71</td></tr><tr><td>NT-500M-1000g</td><td>47.68</td><td>49.31</td><td>52.06</td><td>58.92</td><td>86.58</td><td>69.13</td><td>80.97</td></tr><tr><td>NT-2500M-1000g</td><td>50.86</td><td>56.82</td><td>66.73</td><td>61.99</td><td>86.61</td><td>68.17</td><td>85.78</td></tr><tr><td>NT-2500M-multi</td><td>58.06</td><td>67.01</td><td>73.04</td><td>63.32</td><td>88.14</td><td>71.62</td><td>89.36</td></tr><tr><td>DNABERT-2</td><td>55.98</td><td>67.99</td><td>71.02</td><td>70.10</td><td>84.21</td><td>70.52</td><td>84.99</td></tr><tr><td>DNABERT-2♦</td><td>58.83</td><td>71.21</td><td>68.49</td><td>66.84</td><td>83.81</td><td>71.07</td><td>85.93</td></tr></table>

Table 4: The models' averaged performance on the 7 tasks in the GUE benchmark, including Epigenetic Marks Prediction (EMP), Transcription Factor Prediction on the Human genome and the Mouse genome (TF-H and TF-M), Covid Variants Classification (CVC), Promoter Detection (PD), Core Promoter Detection (CPD), and Splice Site Prediction (SSP).

top two across the 28 tasks of the GUE benchmark. These results showcase the model's remarkable efficiency and effectiveness.

Despite having  $30\%$  more parameters than DNABERT, DNABERT-2 requires only one-third the number of FLOPs. This indicates the superiority of the Byte Pair Encoding (BPE)-based tokenization method over overlapping k-mer tokenization in terms of modeling efficiency. Armed with the new tokenization method and the Attention with Linear Biases (ALiBi) module, DNABERT-2 can effectively process long genome sequences arbitrarily, demonstrating enhanced efficiency. This improvement becomes even more significant as the length of the input sequence increases. Moreover, DNABERT-2 consistently outperforms DNABERT by a large margin, indicating the effectiveness of multi-species pre-training and new model architecture.

Although DNABERT-2 is 5 times smaller, it surpasses NT-500M while using fewer FLOPs. This underscores the importance of providing the model with adequate data, particularly when the model size is scaled up, and further highlights the inefficiency of overlapping k-mer tokenization. The comparison between DNABERT and NT-2500M-1000g exposes the sample inefficiency of non-overlapping k-mer tokenization. Despite being trained on 2.5 times more tokens, NT-2500M-1000g achieves a performance similar to that of DNABERT.

The averaged results for each task are displayed in Table 4. DNABERT-2 and NT-2500M-multi consistently achieve top-tier performance across most tasks. Their dominance over other baselines is particularly notable in non-human genome analysis tasks, demonstrating the effectiveness of multi-species genomes pre-training. Furthermore, models trained on multi-species genomes also show strong performance on human genome analysis tasks, proving their ability to develop a comprehensive understanding of multi-species genomes without compromising their grasp of the human genome. We also observe that additional pre-training does not uniformly enhance all tasks, indicating that task-specific further pre-training might be necessary when addressing a certain downstream task.

Additionally, DNABERT variants achieve optimal performance in the Core Promoter Detection task, where inputs are sequences of length 70. However, their performance diminishes in the similar task of Promoter Detection, where the input length increases to 300. These results highlight a common challenge associated with non-overlapping k-mer tokenization and BPE-based tokenization: the capacity to identify subtle signals from limited input. Although inefficient, the overlapping k-mer tokenization adopted by DNABERT retains most of the information in the original sequences. In contrast, the sequence length is significantly reduced (i.e., from 70 to 15) with non-overlapping k-mer and BPE tokenization, which might limit the retained information and hinder informed decision-making. This identifies a critical area for future exploration in DNA language models.

<table><tr><td>Task</td><td>SC (Fungi)</td><td>SC (Virus)</td><td colspan="6">EPI (Human)</td></tr><tr><td>Dataset</td><td></td><td></td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr><tr><td>DNABERT (6-mer)</td><td>89.29</td><td>44.51</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr><tr><td>NT-2500M-multi</td><td>92.85</td><td>45.00</td><td>61.91</td><td>72.15</td><td>73.13</td><td>79.49</td><td>86.48</td><td>68.64</td></tr><tr><td>DNABERT-2</td><td>93.04</td><td>48.50</td><td>76.21</td><td>79.19</td><td>83.50</td><td>86.71</td><td>92.90</td><td>73.70</td></tr></table>

Table 5: The models' averaged performance on the 3 tasks in the GUE  $^+$  benchmark, including 6 Enhance Promoter Interaction (EPI) datasets and two Species Classification (SC) datasets on virus and fungi. The - means we are not able to fit the model on the dataset after trying multiple sets of hyperparameters.

# 5.4 RESULTS ON GUE

In this section, we further compare DNABERT-2 with DNABERT and Nucleotide Transformers on the  $\mathrm{GUE}^{+}$  benchmark. The input size of datasets in  $\mathrm{GUE}^{+}$  ranges from 5000 to 10000. For DNABERT, due to its 512 input limitation, we follow its origin setting by splitting the input into 512bp-len pieces, generating embedding independently, and feeding the averaged embedding to the output layer. Table 5 shows DNABERT, Nucleotide Transformer, and DNABERT-2's performance on the  $\mathrm{GUE}^{+}$  benchmark. As shown in the table, DNABERT-2 consistently outperforms the baselines on all the datasets, showing its good capability in handling long DNA sequences. Notably, despite DNABERT-2 is pre-trained purely on 700bp-len sequences, it performs well even on 10000-bp sequences with a few epochs of fine-tuning, indicating DNABERT-2's extrapolation capability offered by ALiBi.

# 6 CONCLUSION

In this paper, we introduce DNABERT-2, an efficient foundational model pre-trained on multi-species genomes. We identify the computational and sample inefficiencies of the existing k-mer tokenization method and propose the adaptation of Byte Pair Encoding (BPE) for DNA language modeling. We provide insightful and comprehensive empirical analyses, building DNABERT-2 based on these findings. Moreover, we integrate several techniques such as Attention with Linear Biases (ALiBi) and Low-Rank Adaptation (LoRA) to address the limitations of current DNA language models. We also compile and introduce the Genome Understanding Evaluation, a benchmark for multi-species genome analysis comprising 9 tasks and 36 datasets with well-defined data split, evaluation metrics, and elaborately calibrated difficulty. Empirical analysis on the GUE benchmark shows that DNABERT-2 achieves comparable performance as the SOTA models while being much more efficient. For future work, we are interested in effective modeling strategies for short and extra-long genome sequences and the introduction of training targets and data processing/augmentation methods that leverage the unique double-strand structure of DNA.

# ACKNOWLEDGE

This work is supported by NIH R01LM01372201.

# REFERENCES



Ziga Avsec, Vikram Agarwal, Daniel Visentin, Joseph R Ledsam, Agnieszka Grabska-Barwinska, Kyle R Taylor, Yannis Assael, John Jumper, Pushmeet Kohli, and David R Kelley. Effective gene expression prediction from sequence by integrating long-range interactions. Nature methods, 18 (10):1196-1203, 2021.





Dennis A Benson, Mark Cavanaugh, Karen Clark, Ilene Karsch-Mizrachi, David J Lipman, James Ostell, and Eric W Sayers. Genbank. Nucleic acids research, 41(D1):D36-D42, 2012.





Rishi Bommasani, Drew A. Hudson, Ehsan Adeli, Russ Altman, Simran Arora, Sydney von Arx, Michael S. Bernstein, Jeannette Bohg, Antoine Bosselut, Emma Brunskill, Erik Brynjolfsson, Shyamal Buch, Dallas Card, Rodrigo Castellon, Niladri Chatterji, Annie Chen, Kathleen Creel, Jared Quincy Davis, Dora Demszky, Chris Donahue, Moussa Doumbouya, Esin Durmus, Stefano





Ermon, John Etchemendy, Kawin Ethayarajh, Li Fei-Fei, Chelsea Finn, Trevor Gale, Lauren Gillespie, Karan Goel, Noah Goodman, Shelby Grossman, Neel Guha, Tatsunori Hashimoto, Peter Henderson, John Hewitt, Daniel E. Ho, Jenny Hong, Kyle Hsu, Jing Huang, Thomas Icard, Saahil Jain, Dan Jurafsky, Pratyusha Kalluri, Siddharth Karamcheti, Geoff Keeling, Fereshte Khani, Omar Khattab, Pang Wei Koh, Mark Krass, Ranjay Krishna, Rohith Kuditipudi, Ananya Kumar, Faisal Ladhak, Mina Lee, Tony Lee, Jure Leskovec, Isabelle Levent, Xiang Lisa Li, Xuechen Li, Tengyu Ma, Ali Malik, Christopher D. Manning, Suvir Mirchandani, Eric Mitchell, Zanele Munyikwa, Suraj Nair, Avanika Narayan, Deepak Narayanan, Ben Newman, Allen Nie, Juan Carlos Niebles, Hamed Nilforoshan, Julian Nyarko, Giray Ogut, Laurel Orr, Isabel Papadimitriou, Joon Sung Park, Chris Piech, Eva Portelance, Christopher Potts, Aditi Raghunathan, Rob Reich, Hongyu Ren, Frieda Rong, Yusuf Roohani, Camilo Ruiz, Jack Ryan, Christopher Ré, Dorsa Sadigh, Shiori Sagawa, Keshav Santhanam, Andy Shih, Krishnan Srinivasan, Alex Tamkin, Rohan Taori, Armin W. Thomas, Florian Tramer Rose E. Wang William Wang Bohan Wu Jiajun Wu Yuhuai Wu Sang Michael Xie, Michihiro Yasunaga, Jiaxuan You Matei Zaharia Michael Zhang Tianyi Zhang, Xikun Zhang, Yuhui Zhang Lucia Zheng Kaitlyn Zhou and Percy Liang. On the opportunities and risks of foundation models, 2022.





Marta Byrska-Bishop, Uday S. Evani, Xuefang Zhao, Anna O. Basile, Haley J. Abel, Allison A. Regier, André Corvelo, Wayne E. Clarke, Rajeeva Musunuri, Kshithija Nagulapalli, Susan Fairley, Alexi Runnels, Lara Winterkorn, Ernesto Lowy-Gallego, The Human Genome Structural Variation Consortium, Paul Flicek, Soren Germer, Harrison Brand, Ira M. Hall, Michael E. Talkowski, Giuseppe Narzisi, and Michael C. Zody. High coverage whole genome sequencing of the expanded 1000 genomes project cohort including 602 trios. bioRxiv, 2021. doi: 10.1101/2021.02.06.430068. URL https://www.biorxiv.org/content/early/2021/02/07/2021.02.06.430068.





Ken Chen, Huiying Zhao, and Yuedong Yang. Capturing large genomic contexts for accurately predicting enhancer-promoter interactions. *Brief. Bioinform.*, 23(2), March 2022.





ENCODE Project Consortium et al. An integrated encyclopedia of dna elements in the human genome. Nature, 489(7414):57, 2012.





Hugo Dalla-Torre, Liam Gonzalez, Javier Mendoza-Revilla, Nicolas Lopez Carranza, Adam Henryk Grzywaczewski, Francesco Oteri, Christian Dallago, Evan Trop, Hassan Sirelkhatim, Guillaume Richard, Marcin Skwark, Karim Beguir, Marie Lopez, and Thomas Pierrot. The nucleotide transformer: Building and evaluating robust foundation models for human genomics. bioRxiv, 2023. doi: 10.1101/2023.01.11.523679. URL https://www.biorxiv.org/content/early/2023/03/09/2023.01.11.523679.





Tri Dao, Daniel Y. Fu, Stefano Ermon, Atri Rudra, and Christopher Ré. Flashattention: Fast and memory-efficient exact attention with io-awareness, 2022.





Yann N. Dauphin, Angela Fan, Michael Auli, and David Grangier. Language modeling with gated convolutional networks. In Proceedings of the 34th International Conference on Machine Learning - Volume 70, ICML'17, pp. 933-941. JMLR.org, 2017.





Réné Dreos, Giovanna Ambrosini, Rouayda Cavin Périer, and Philipp Bucher. Epd and epdnew, high-quality promoter resources in the next-generation sequencing era. *Nucleic acids research*, 41 (D1):D157–D164, 2013.





Katarína Grešová, Vlastimil Martinek, David Čechák, Petr Šimeček, and Panagiotis Alexiou. Genomic benchmarks: a collection of datasets for genomic sequence classification. BMC Genomic Data, 24(1):25, 2023.





Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuzhhi Li, Shean Wang, Lu Wang, and Weizhu Chen. Lora: Low-rank adaptation of large language models, 2021.





Yanrong Ji, Zhihan Zhou, Han Liu, and Ramana V Davuluri. Dnabert: pre-trained bidirectional encoder representations from transformers model for dna-language in genome. Bioinformatics, 37 (15):2112-2120, 2021.





Junru Jin, Yingying Yu, Ruheng Wang, Xin Zeng, Chao Pang, Yi Jiang, Zhongshen Li, Yutong Dai, Ran Su, Quan Zou, Kenta Nakai, and Leyi Wei. iDNA-ABF: multi-scale deep biological language learning model for the interpretable prediction of DNA methylations. Genome Biol., 23(1):219, October 2022.





Jacob Devlin Ming-Wei Chang Kenton and Lee Kristina Toutanova. Bert: Pre-training of deep bidirectional transformers for language understanding. In Proceedings of NAACL-HLT, pp. 4171-4186, 2019.





Shruti Khare, Céline Gurry, Lucas Freitas, Mark B Schultz, Gunter Bach, Amadou Diallo, Nancy Akite, Joses Ho, Raphael TC Lee, Winston Yeo, et al. Gisaid's role in pandemic response. China CDC weekly, 3(49):1049, 2021.





Taku Kudo and John Richardson. Sentencepiece: A simple and language independent subword tokenizer and tokenizer for neural text processing, 2018.





Nguyen Quoc Khanh Le, Quang-Thai Ho, Van-Nui Nguyen, and Jung-Su Chang. Bert-promoter: An improved sequence-based predictor of dna promoter using bert pre-trained model and shap feature selection. Computational Biology and Chemistry, 99:107732, 2022.





Dohoon Lee, Jeewon Yang, and Sun Kim. Learning the histone codes with large genomic windows and three-dimensional chromatin interactions using transformer. Nature Communications, 13(1): 6678, 2022.





Zhongxiao Li, Elva Gao, Juexiao Zhou, Wenkai Han, Xiaopeng Xu, and Xin Gao. Applications of deep learning in understanding gene regulation. Cell Reports Methods, 3(1):100384, 2023. ISSN 2667-2375. doi: https://doi.org/10.1016/j.crmeth.2022.100384. URL https://www.sciencedirect.com/science/article/pii/S2667237522002892.





Ilya Loshchilov and Frank Hutter. Decoupled weight decay regularization, 2019.





Eric Nguyen, Michael Poli, Marjan Faizi, Armin Thomas, Michael Wornow, Callum Birch-Sykes, Stefano Massaroli, Aman Patel, Clayton Rabideau, Yoshua Bengio, et al. Hyenadna: Long-range genomic sequence modeling at single nucleotide resolution. Advances in neural information processing systems, 36, 2024.





Yu Ni, Linqi Fan, Miao Wang, Ning Zhang, Yongchun Zuo, and Mingzhi Liao. EPI-Mind: Identifying enhancer-promoter interactions based on transformer mechanism. Interdiscip. Sci., 14(3):786-794, September 2022.





OpenAI. Gpt-4 technical report, 2023.





Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul Christiano, Jan Leike, and Ryan Lowe. Training language models to follow instructions with human feedback, 2022.





Ofir Press, Noah A Smith, and Mike Lewis. Train short, test long: Attention with linear biases enables input length extrapolation. arXiv preprint arXiv:2108.12409, 2021.





Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J Liu. Exploring the limits of transfer learning with a unified text-to-text transformer. The Journal of Machine Learning Research, 21(1):5485-5551, 2020.





Joel Rozowsky, Jiahao Gao, Beatrice Borsari, Yucheng T Yang, Timur Galeev, Gamze Gursoy, Charles B Epstein, Kun Xiong, Jinrui Xu, Tianxiao Li, Jason Liu, Keyang Yu, Ana Berthel, Zhanlin Chen, Fabio Navarro, Maxwell S Sun, James Wright, Justin Chang, Christopher J F Cameron, Noam Shoresh, Elizabeth Gaskell, Jorg Drenkow, Jessika Adrian, Sergey Aganezov, François Aguet, Gabriela Balderrama-Gutierrez, Samridhi Banskota, Guillermo Barreto Corona, Sora Chee, Surya B Chhetri, Gabriel Conte Cortez Martins, Cassidy Danyko, Carrie A Davis, Daniel Farid, Nina P Farrell, Idan Gabdank, Yoel Gofin, David U Gorkin, Mengting Gu, Vivian Hecht, Benjamin C Hitz, Robbyn Issner, Yunzhe Jiang, Melanie Kirsche, Xiangmeng Kong, Bonita R Lam, Shantao Li, Bian Li, Xiqi Li, Khine Zin Lin, Ruibang Luo, Mark Mackiewicz, Ran Meng,





Jill E Moore, Jonathan Mudge, Nicholas Nelson, Chad Nusbaum, Ioann Popov, Henry E Pratt, Yunjiang Qiu, Srividya Ramakrishnan, Joe Raymond, Leonidas Salichos, Alexandra Scavelli, Jacob M Schreiber, Fritz J Sedlazeck, Lei Hoon See, Rachel M Sherman, Xu Shi, Minyi Shi, Cricket Alicia Sloan, J Seth Strattan, Zhen Tan, Forrest Y Tanaka, Anna Vlasova, Jun Wang, Jonathan Werner, Brian Williams, Min Xu, Chengfei Yan, Lu Yu, Christopher Zaleski, Jing Zhang, Kristin Ardlie, J Michael Cherry, Eric M Mendenhall, William S Noble, Zhiping Weng, Morgan E Levine, Alexander Dobin, Barbara Wold, Ali Mortazavi, Bing Ren, Jesse Gillis, Richard M Myers, Michael P Snyder, Jyoti Choudhary, Aleksandar Milosavljevic, Michael C Schatz, Bradley E Bernstein, Roderic Guigó, Thomas R Gingeras, and Mark Gerstein. The EN-TEx resource of multi-tissue personal epigenomes & variant-impact models. Cell, 186(7):1493-1511.e40, March 2023.





Rico Sennrich, Barry Haddow, and Alexandra Birch. Neural machine translation of rare words with subword units. In Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pp. 1715-1725, Berlin, Germany, August 2016. Association for Computational Linguistics. doi: 10.18653/v1/P16-1162. URL https://aclanthology.org/P16-1162.





Noam Shazeer. Glu variants improve transformer, 2020.





Gabrielle D Smith, Wan Hern Ching, Paola Cornejo-Paramo, and Emily S Wong. Decoding enhancer complexity with machine learning and high-throughput discovery. Genome Biol., 24(1):116, May 2023.





John A Stamatoyannopoulos, Michael Snyder, Ross Hardison, Bing Ren, Thomas Gingeras, David M Gilbert, Mark Groudine, Michael Bender, Rajinder Kaul, Theresa Canfield, et al. An encyclopedia of mouse dna elements (mouse encode). Genome biology, 13(8):1-5, 2012.





Jianlin Su, Yu Lu, Shengfeng Pan, Ahmed Murtadha, Bo Wen, and Yunfeng Liu. Roformer: Enhanced transformer with rotary position embedding. arXiv preprint arXiv:2104.09864, 2021.





Chi Sun, Xipeng Qiu, Yige Xu, and Xuanjing Huang. How to fine-tune bert for text classification?, 2020.





The Mosaic ML Team. composer. https://github.com/mosaicml/composer/, 2021.





Christina V Theodoris, Ling Xiao, Anant Chopra, Mark D Chaffin, Zeina R Al Sayed, Matthew C Hill, Helene Mantineo, Elizabeth M Brydon, Zexian Zeng, X Shirley Liu, and Patrick T Ellinor. Transfer learning enables predictions in network biology. Nature, 618(7965):616-624, June 2023.





Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Lukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.





Ruohan Wang, Zishuai Wang, Jianping Wang, and Shuaicheng Li. Splicefinder: ab initio prediction of splice sites using convolutional neural network. BMC bioinformatics, 20:1-13, 2019.





Zixuan Wang, Yongqing Zhang, Yuhang Liu, Shuwen Xiong, Maocheng Wang, Jiliu Zhou, and Meiqin Gong. Towards a better understanding of tf-dna binding prediction from genomic features. Computers in Biology and Medicine, pp. 105993, 2022.





Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumont, Clement Delangue, Anthony Moi, Pierrick Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest, and Alexander M. Rush. Transformers: State-of-the-art natural language processing. In Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System Demonstrations, pp. 38-45, Online, October 2020. Association for Computational Linguistics. URL https://www.aclweb.org/anthology/2020.emnlp-demos.6.





Pengyu Zhang, Hongming Zhang, and Hao Wu. ipro-wael: a comprehensive and robust framework for identifying promoters in multiple species. *Nucleic Acids Research*, 50(18):10278-10289, 2022.



# A EXPERIMENTS

# A.1 ALL EXPERIMENT RESULTS

<table><tr><td rowspan="2"></td><td colspan="8">Epigenetic Marks Prediction</td></tr><tr><td>H3</td><td>H3K14ac</td><td colspan="2">H3K36me3</td><td>H3K4me1</td><td colspan="2">H3K4me2</td><td>H3K4me3</td></tr><tr><td>DNABERT (3-mer)</td><td>74.15</td><td>42.07</td><td colspan="2">48.49</td><td>42.95</td><td colspan="2">31.34</td><td>28.92</td></tr><tr><td>DNABERT (4-mer)</td><td>73.03</td><td>41.88</td><td colspan="2">48.03</td><td>41.06</td><td colspan="2">30.66</td><td>25.31</td></tr><tr><td>DNABERT (5-mer)</td><td>73.40</td><td>40.68</td><td colspan="2">48.29</td><td>40.65</td><td colspan="2">30.67</td><td>27.10</td></tr><tr><td>DNABERT (6-mer)</td><td>73.10</td><td>40.06</td><td colspan="2">47.25</td><td>41.44</td><td colspan="2">32.27</td><td>27.81</td></tr><tr><td>NT-500M-human</td><td>69.67</td><td>33.55</td><td colspan="2">44.14</td><td>37.15</td><td colspan="2">30.87</td><td>24.06</td></tr><tr><td>NT-500M-1000g</td><td>72.52</td><td>39.37</td><td colspan="2">45.58</td><td>40.45</td><td colspan="2">31.05</td><td>26.16</td></tr><tr><td>NT-2500M-1000g</td><td>74.61</td><td>44.08</td><td colspan="2">50.86</td><td>43.10</td><td colspan="2">30.28</td><td>30.87</td></tr><tr><td>NT-2500M-multi</td><td>78.77</td><td>56.20</td><td colspan="2">61.99</td><td>55.30</td><td colspan="2">36.49</td><td>40.34</td></tr><tr><td>DNABERT-2</td><td>78.27</td><td>52.57</td><td colspan="2">56.88</td><td>50.52</td><td colspan="2">31.13</td><td>36.27</td></tr><tr><td>DNABERT-2◆</td><td>80.17</td><td>57.42</td><td colspan="2">61.90</td><td>53.00</td><td colspan="2">39.89</td><td>41.20</td></tr><tr><td rowspan="2"></td><td colspan="5">Epigenetic Marks Prediction</td><td colspan="3">Promoter Detection</td></tr><tr><td colspan="2">H3K79me3</td><td colspan="2">H3K9ac</td><td>H4</td><td>H4ac</td><td>all</td><td>notata</td></tr><tr><td>DNABERT (3-mer)</td><td colspan="2">60.12</td><td colspan="2">50.48</td><td>78.27</td><td>38.60</td><td>90.44</td><td>93.61</td></tr><tr><td>DNABERT (4-mer)</td><td colspan="2">59.77</td><td colspan="2">51.44</td><td>78.28</td><td>36.40</td><td>89.54</td><td>92.65</td></tr><tr><td>DNABERT (5-mer)</td><td colspan="2">59.61</td><td colspan="2">51.11</td><td>77.27</td><td>37.48</td><td>90.16</td><td>92.45</td></tr><tr><td>DNABERT (6-mer)</td><td colspan="2">61.17</td><td colspan="2">51.22</td><td>79.26</td><td>37.43</td><td>90.48</td><td>93.05</td></tr><tr><td>NT-500M-human</td><td colspan="2">58.35</td><td colspan="2">45.81</td><td>76.17</td><td>33.74</td><td>87.71</td><td>90.75</td></tr><tr><td>NT-500M-1000g</td><td colspan="2">59.33</td><td colspan="2">49.29</td><td>76.29</td><td>36.79</td><td>89.76</td><td>91.75</td></tr><tr><td>NT-2500M-1000g</td><td colspan="2">61.20</td><td colspan="2">52.36</td><td>79.76</td><td>41.46</td><td>90.95</td><td>93.07</td></tr><tr><td>NT-2500M-multi</td><td colspan="2">64.70</td><td colspan="2">56.01</td><td>81.67</td><td>49.13</td><td>91.01</td><td>94.00</td></tr><tr><td>DNABERT-2</td><td colspan="2">67.39</td><td colspan="2">55.63</td><td>80.71</td><td>50.43</td><td>86.77</td><td>94.27</td></tr><tr><td>DNABERT-2◆</td><td colspan="2">65.46</td><td colspan="2">57.07</td><td>81.86</td><td>50.35</td><td>88.31</td><td>94.34</td></tr><tr><td rowspan="2"></td><td colspan="5">Transcription Factor Prediction (Human)</td><td colspan="3">Core Promoter Detection</td></tr><tr><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>all</td><td>notata</td><td>tata</td></tr><tr><td>DNABERT (3-mer)</td><td>67.95</td><td>70.90</td><td>60.51</td><td>53.03</td><td>69.76</td><td>70.92</td><td>69.82</td><td>78.15</td></tr><tr><td>DNABERT (4-mer)</td><td>67.90</td><td>73.05</td><td>59.52</td><td>50.37</td><td>71.23</td><td>69.00</td><td>70.04</td><td>74.25</td></tr><tr><td>DNABERT (5-mer)</td><td>66.97</td><td>69.98</td><td>59.03</td><td>52.95</td><td>69.26</td><td>69.48</td><td>69.81</td><td>76.79</td></tr><tr><td>DNABERT (6-mer)</td><td>66.84</td><td>70.14</td><td>61.03</td><td>51.89</td><td>70.97</td><td>68.90</td><td>70.47</td><td>76.06</td></tr><tr><td>NT-500M-human</td><td>61.59</td><td>66.75</td><td>53.58</td><td>42.95</td><td>60.81</td><td>63.45</td><td>64.82</td><td>71.34</td></tr><tr><td>NT-500M-1000g</td><td>63.64</td><td>70.17</td><td>52.73</td><td>45.24</td><td>62.82</td><td>66.70</td><td>67.17</td><td>73.52</td></tr><tr><td>NT-2500M-1000g</td><td>66.31</td><td>68.30</td><td>58.70</td><td>49.08</td><td>67.59</td><td>67.39</td><td>67.46</td><td>69.66</td></tr><tr><td>NT-2500M-multi</td><td>66.64</td><td>70.28</td><td>58.72</td><td>51.65</td><td>69.34</td><td>70.33</td><td>71.58</td><td>72.97</td></tr><tr><td>DNABERT-2</td><td>71.99</td><td>76.06</td><td>66.52</td><td>58.54</td><td>77.43</td><td>69.37</td><td>68.04</td><td>74.17</td></tr><tr><td>DNABERT-2◆</td><td>69.12</td><td>71.87</td><td>62.96</td><td>55.35</td><td>74.94</td><td>67.50</td><td>69.53</td><td>76.18</td></tr><tr><td rowspan="2"></td><td colspan="5">Transcription Factor Prediction (Mouse)</td><td>Virus</td><td colspan="2">Splice</td></tr><tr><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>Covid</td><td colspan="2">Reconstruct</td></tr><tr><td>DNABERT (3-mer)</td><td>42.31</td><td>79.10</td><td>69.90</td><td>55.40</td><td>41.97</td><td>62.23</td><td></td><td>84.14</td></tr><tr><td>DNABERT (4-mer)</td><td>49.42</td><td>79.95</td><td>72.62</td><td>51.79</td><td>44.13</td><td>59.87</td><td></td><td>84.05</td></tr><tr><td>DNABERT (5-mer)</td><td>42.45</td><td>79.32</td><td>62.22</td><td>49.92</td><td>40.34</td><td>50.46</td><td></td><td>84.02</td></tr><tr><td>DNABERT (6-mer)</td><td>44.42</td><td>78.94</td><td>71.44</td><td>44.89</td><td>42.48</td><td>55.50</td><td></td><td>84.07</td></tr><tr><td>NT-500M-human</td><td>31.04</td><td>75.04</td><td>61.67</td><td>29.17</td><td>29.27</td><td>50.82</td><td></td><td>79.71</td></tr><tr><td>NT-500M-1000g</td><td>39.26</td><td>75.49</td><td>64.70</td><td>33.07</td><td>34.01</td><td>52.06</td><td></td><td>80.97</td></tr><tr><td>NT-2500M-1000g</td><td>48.31</td><td>80.02</td><td>70.14</td><td>42.25</td><td>43.40</td><td>66.73</td><td></td><td>85.78</td></tr><tr><td>NT-2500M-multi</td><td>63.31</td><td>83.76</td><td>71.52</td><td>69.44</td><td>47.07</td><td>73.04</td><td></td><td>89.35</td></tr><tr><td>DNABERT-2</td><td>56.76</td><td>84.77</td><td>79.32</td><td>66.47</td><td>52.66</td><td>71.02</td><td></td><td>84.99</td></tr><tr><td>DNABERT-2◆</td><td>64.23</td><td>86.28</td><td>81.28</td><td>73.49</td><td>50.80</td><td>68.49</td><td></td><td>85.93</td></tr></table>

Table 6: This table presents the performance of all the models on the GUE benchmark.  $\spadesuit$  : perform further pre-training on the training sets of the GUE benchmark.

<table><tr><td></td><td>EMP</td><td>TF-M</td><td>CVC</td><td>TF-H</td><td>PD-tata</td><td>PD-o</td><td>CPD-tata</td><td>CPD-o</td><td>SSP</td></tr><tr><td>Epochs</td><td>3</td><td>1k</td><td>8</td><td>3</td><td>10</td><td>4</td><td>10</td><td>4</td><td>5</td></tr></table>

Table 7: The number of training steps we used for the following tasks: Epigenetic Marks Prediction (EMP), Transcription Factor Prediction on the Human genome and the Mouse genome (TF-H and TF-M), Covid Variants Classification (CVC), tata dataset of Promoter Detection (PD-tata), notata and all datasets of Promoter Detection (PD-o), tata dataset of Core Promoter Detection (CPD-tata), notata and all datasets of Core Promoter Detection (CPD-o), and Splice Site Prediction (SSP). In the task of Transcription Factor Prediction on the Mouse genome, we train the model for 1000 steps on each dataset.

Table 6 presents the evaluation results of DNABERT-2 and baselines on the GUE benchmark.

# A.2 IMPLEMENTATION

We pre-train DNABERT-2 with the Masked Language Modeling (MLM) loss with a mask ratio of  $15\%$ . Notably, we independently mask every token instead of masking spans of continuous tokens like Ji et al. (2021). We use a batch size of 4096 and a max sequence length of 128. We train the model for 500000 steps using the AdamW (Loshchilov & Hutter, 2019) optimizer with  $\beta_{1} = 0.9$ ,  $\beta_{2} = 0.98$ ,  $\epsilon = 1e - 6$  and weight decay of  $1e - 5$ . The learning rate linearly increases from 0 to  $5e - 4$  during the first 30000 steps while linearly decreasing to 0 in the last 470000 steps.

# A.3 HYPERPARAMETERS

This section presents the hyperparameters we used in the fine-tuning stage on each model. Table 7 shows the number of training steps we used for each task. We use AdamW (Loshchilov & Hutter, 2019) as optimizer. We keep most of the other hyperparameters the same for all the models across all the datasets, including a batch size of 32, a warmup step of 50, and a weight decay of 0.01. For DNABERT and DNABERT-2, we perform standard fine-tuning with a learning rate of  $3e - 5$ , while for the Nucleotide Transformers, we perform parameter efficient fine-tuning (PEFT) using Low-Rank Adaptation (LoRA) with a learning rate of  $1e - 4$ , a LoRA alpha of 16, a LoRA dropout of 0.05, and a LoRA  $r$  of 8. The hyperparameters are selected based on grid searches over commonly used ones in preliminary experiments. The pre-training stage takes approximately 14 days using eight Nvidia RTX 2080Ti GPUs. To train the model, we used the Transformers library (Wolf et al., 2020) and the Composer library (Team, 2021).

# A.4 PRELIMINARY EXPERIMENTS ON NUCLEOTIDE TRANSFORMER

Since there is no official fine-tuning code of Nucleotide Transformer (Dalla-Torre et al., 2023), we use its open-sourced checkpoints in Huggingface Modelhub and train it with our code base using LoRA. For a fair comparison with this model, in this section, we present preliminary experiments that compare the results reported in their paper with the performance of this model under our implementation. We select the epigenetic marks prediction task for benchmarking since it is the only shared task among Dalla-Torre et al. (2023) and GUE. The task contains 10 datasets. For each dataset, we randomly split it into training and test sets with a ratio of 9:1. As shown in Table 8, our LoRA implementation leads to slightly better results than the results reported in the original paper, making our comparison to the model fair and convincing despite the fact that we do not have access to its official fine-tuning implementation.

<table><tr><td></td><td>H3</td><td>H3K14ac</td><td>H3K36me3</td><td>H3K4me1</td><td>H3K4me2</td><td>H3K4me3</td></tr><tr><td>500M-human*</td><td>72.00</td><td>37.00</td><td>45.00</td><td>36.00</td><td>27.00</td><td>24.00</td></tr><tr><td>500M-human</td><td>69.67</td><td>33.55</td><td>44.14</td><td>37.15</td><td>30.87</td><td>24.06</td></tr><tr><td>500M-1000g*</td><td>74.00</td><td>38.00</td><td>47.00</td><td>38.00</td><td>26.00</td><td>24.00</td></tr><tr><td>500M-1000g</td><td>72.52</td><td>39.37</td><td>45.58</td><td>40.45</td><td>31.05</td><td>26.16</td></tr><tr><td>2500M-1000g*</td><td>75.00</td><td>45.00</td><td>53.00</td><td>42.00</td><td>28.00</td><td>31.00</td></tr><tr><td>2500M-1000g</td><td>74.61</td><td>44.08</td><td>50.86</td><td>43.10</td><td>30.28</td><td>30.87</td></tr><tr><td>2500M-multi*</td><td>79.00</td><td>54.00</td><td>62.00</td><td>54.00</td><td>32.00</td><td>41.00</td></tr><tr><td>2500M-multi</td><td>78.77</td><td>56.20</td><td>61.99</td><td>55.30</td><td>36.49</td><td>40.34</td></tr></table>

<table><tr><td></td><td>H3K79me3</td><td>H3K9ac</td><td>H4</td><td>H4ac</td><td>Average</td></tr><tr><td>500M-human*</td><td>57.00</td><td>45.00</td><td>75.00</td><td>33.00</td><td>45.10</td></tr><tr><td>500M-human</td><td>58.35</td><td>45.81</td><td>76.17</td><td>33.74</td><td>45.35</td></tr><tr><td>500M-1000g*</td><td>56.00</td><td>48.00</td><td>76.00</td><td>34.00</td><td>46.10</td></tr><tr><td>500M-1000g</td><td>59.33</td><td>49.29</td><td>76.29</td><td>36.79</td><td>47.68</td></tr><tr><td>2500M-1000g*</td><td>57.00</td><td>49.00</td><td>79.00</td><td>41.00</td><td>50.00</td></tr><tr><td>2500M-1000g</td><td>61.20</td><td>52.36</td><td>79.76</td><td>41.46</td><td>50.86</td></tr><tr><td>2500M-multi*</td><td>62.00</td><td>55.00</td><td>81.00</td><td>49.00</td><td>56.90</td></tr><tr><td>2500M-multi</td><td>64.70</td><td>56.01</td><td>81.67</td><td>49.13</td><td>58.06</td></tr></table>

Table 8: This table presents the performance of the Nucleotide Transformer on ten datasets of epigenetic marks prediction on the Yeast genome. As shown in the table, our implementation achieves better performance than the results reported in the paper, indicating the fairness of comparison in our experiments. \*: Results taken from Dalla-Torre et al. (2023).

# A.5 COMPARING DNABERT-2 WITH OTHER BASELINES

We also compare DNABERT-2 with other baselines, including HyenaDNA (Nguyen et al., 2024), a convolutional neural network (CNN) designed for DNA classification by Grešová et al. (2023), and DNABERT-2 model without pre-training. We implement HyenaDNA with their official implementation https://huggingface.co/LongSafari/hyenadna-medium-450k-seqlen-hf on HuggingFace and Huggingface Trainer. We implement CNN with official code on GitHub. For both papers, we use the default hyperparameter described in the papers, and we follow our own evaluation setting (e.g., use the same set of hyperparameters across all the datasets and test on the checkpoint with the lowest validation loss).

As shown in Table 9, DNABERT-2 consistently outperforms the baselines. We note that using the official checkpoint of HyenaDNA on Huggingface does not achieve the same level of performance on the EMP task as reported in their paper. This could be due to multiple reasons: 1) the reported results are not based on the open-source checkpoints, 2) the Huggingface trainer does not train the model properly, and 3) more careful hyperparameter searches are needed.

# A.6 ABLATION STUDY ONTOKENIZATION METHOD

In this section, we present an ablation study on the tokenization method: the overlapping K-mer tokenization used in DNABERT v.s. the BPE tokenization used in DNABERT-2. We train two DNABERT-2 variants on the same training data and with the same model architecture and hyperparameters. We use a batch size of 4096, max sequence length of 128, and train each model for 120,000 steps. Since the vocab size of BPE is 4096, to keep the number of parameters similar enough, we use 6-mer tokenization, which results in 4101 tokens. We then evaluate the two variants on the GUE benchmark. Table 10 presents the results. As shown in the Table, the variant trained with the BPE tokenizer outperforms the K-mer counterparts on 21 out of 28 datasets, with an average score of 65.33 and 60.92, respectively. As a result, we empirically show that BPE leads to better performance than k-mer after being pre-trained and finetuned with the same data, architecture, and hyperparameters,

<table><tr><td rowspan="2"></td><td colspan="8">Epigenetic Marks Prediction</td></tr><tr><td>H3</td><td>H3K14ac</td><td colspan="2">H3K36me3</td><td colspan="2">H3K4me1</td><td colspan="2">H3K4me2</td></tr><tr><td>HyenaDNA</td><td>67.17</td><td>31.98</td><td colspan="2">48.27</td><td colspan="2">35.83</td><td colspan="2">25.81</td></tr><tr><td>CNN</td><td>61.52</td><td>29.73</td><td colspan="2">38.60</td><td colspan="2">26.06</td><td colspan="2">25.76</td></tr><tr><td>DNABERT-2 w/o PT</td><td>57.36</td><td>32.25</td><td colspan="2">38.07</td><td colspan="2">23.80</td><td colspan="2">28.57</td></tr><tr><td>DNABERT-2</td><td>78.27</td><td>52.57</td><td colspan="2">56.88</td><td colspan="2">50.52</td><td colspan="2">31.13</td></tr><tr><td rowspan="2"></td><td colspan="6">Epigenetic Marks Prediction</td><td colspan="2">Promoter Detection</td></tr><tr><td colspan="2">H3K79me3</td><td>H3K9ac</td><td>H4</td><td colspan="2">H4ac</td><td>all</td><td>notata</td></tr><tr><td>HyenaDNA</td><td colspan="2">54.09</td><td>50.84</td><td>73.69</td><td colspan="2">38.44</td><td>47.38</td><td>52.24</td></tr><tr><td>CNN</td><td colspan="2">46.30</td><td>40.03</td><td>62.34</td><td colspan="2">25.54</td><td>75.78</td><td>85.14</td></tr><tr><td>DNABERT-2 w/o PT</td><td colspan="2">51.71</td><td>44.38</td><td>66.73</td><td colspan="2">30.07</td><td>76.49</td><td>84.07</td></tr><tr><td>DNABERT-2</td><td colspan="2">67.39</td><td>55.63</td><td>80.71</td><td colspan="2">50.43</td><td>86.77</td><td>94.27</td></tr><tr><td rowspan="2"></td><td colspan="6">Transcription Factor Prediction (Human)</td><td colspan="2">Core Promoter Detection</td></tr><tr><td>0</td><td>1</td><td>2</td><td>3</td><td colspan="2">4</td><td>all</td><td>notata</td></tr><tr><td>HyenaDNA</td><td>62.3</td><td>67.86</td><td>46.85</td><td>41.78</td><td colspan="2">61.23</td><td>36.95</td><td>35.38</td></tr><tr><td>CNN</td><td>53.95</td><td>63.20</td><td>45.22</td><td>29.84</td><td colspan="2">61.48</td><td>58.07</td><td>60.09</td></tr><tr><td>DNABERT-2 w/o PT</td><td>59.35</td><td>59.27</td><td>46.13</td><td>31.36</td><td colspan="2">60.14</td><td>54.58</td><td>58.26</td></tr><tr><td>DNABERT-2</td><td>84.38</td><td>87.16</td><td>83.99</td><td>79.85</td><td colspan="2">87.80</td><td>69.47</td><td>68.04</td></tr><tr><td rowspan="2"></td><td colspan="6">Transcription Factor Prediction (Mouse)</td><td>Virus</td><td>Splice</td></tr><tr><td>0</td><td>1</td><td>2</td><td>3</td><td colspan="2">4</td><td>Covid</td><td>Reconstruct</td></tr><tr><td>HyenaDNA</td><td>35.62</td><td>80.50</td><td>65.34</td><td>54.20</td><td colspan="2">19.17</td><td>23.27</td><td>72.67</td></tr><tr><td>CNN 0</td><td>31.14</td><td>59.74</td><td>63.15</td><td>45.48</td><td colspan="2">27.18</td><td>22.23</td><td>76.79</td></tr><tr><td>DNABERT-2 w/o PT</td><td>30.55</td><td>63.74</td><td>59.92</td><td>24.12</td><td colspan="2">27.20</td><td>69.76</td><td>46.80</td></tr><tr><td>DNABERT-2</td><td>81.60</td><td>92.67</td><td>92.38</td><td>84.91</td><td colspan="2">76.10</td><td>71.02</td><td>84.99</td></tr></table>

Table 9: Benchmark DNABERT-2 with HyenaDNA (Nguyen et al., 2024), CNN (Grešová et al., 2023), and DNABERT-2 without pre-training on GUE.

showing its data efficiency. Also, as shown in Table 6 of the paper, BPE also leads to 3-4 times less computational costs than K-mer.

<table><tr><td rowspan="2">Tokenizer</td><td colspan="8">Epigenetic Marks Prediction</td></tr><tr><td>H3</td><td>H3K14ac</td><td colspan="2">H3K36me3</td><td>H3K4me1</td><td colspan="2">H3K4me2</td><td>H3K4me3</td></tr><tr><td>K-mer</td><td>74.62</td><td>42.71</td><td colspan="2">47.26</td><td>39.66</td><td colspan="2">25.33</td><td>27.43</td></tr><tr><td>BPE</td><td>77.08</td><td>55.60</td><td colspan="2">57.25</td><td>45.51</td><td colspan="2">40.83</td><td>42.57</td></tr><tr><td></td><td colspan="5">Epigenetic Marks Prediction</td><td colspan="3">Promoter Detection</td></tr><tr><td>Tokenizer</td><td colspan="2">H3K79me3</td><td>H3K9ac</td><td>H4</td><td>H4ac</td><td>all</td><td>notata</td><td>tata</td></tr><tr><td>K-mer</td><td colspan="2">61.03</td><td>49.35</td><td>78.61</td><td>37.14</td><td>83.78</td><td>92.65</td><td>57.75</td></tr><tr><td>BPE</td><td colspan="2">66.01</td><td>56.79</td><td>80.07</td><td>54.19</td><td>85.57</td><td>92.55</td><td>60.85</td></tr><tr><td></td><td colspan="5">Transcription Factor Prediction (Human)</td><td colspan="3">Core Promoter Detection</td></tr><tr><td>Tokenizer</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>all</td><td>notata</td><td>tata</td></tr><tr><td>K-mer</td><td>67.99</td><td>67.06</td><td>59.45</td><td>50.24</td><td>72.80</td><td>74.91</td><td>69.23</td><td>74.91</td></tr><tr><td>BPE</td><td>66.99</td><td>70.98</td><td>61.40</td><td>55.10</td><td>71.31</td><td>66.28</td><td>67.99</td><td>72.73</td></tr><tr><td></td><td colspan="5">Transcription Factor Prediction (Mouse)</td><td>Virus</td><td colspan="2">Splice</td></tr><tr><td>Tokenizer</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>Covid</td><td colspan="2">Reconstruct</td></tr><tr><td>K-mer</td><td>48.96</td><td>81.69</td><td>81.71</td><td>63.17</td><td>42.83</td><td>62.16</td><td></td><td>77.90</td></tr><tr><td>BPE</td><td>48.01</td><td>81.86</td><td>82.98</td><td>73.22</td><td>46.15</td><td>69.75</td><td></td><td>79.62</td></tr></table>


Table 10: This table presents the ablation study on tokenization methods.


# B DATA

# B.1 MULTI-SPECIES GENOME FOR PRE-TRAINING

Table 11 lists the 135 species in 7 categories that we randomly selected for genome foundation model pre-training and presents the number of nucleotides we achieved from each species.

<table><tr><td>Category</td><td>Species</td><td>Num. of Nucleotides (M)</td></tr><tr><td rowspan="11">Fungi</td><td>Ceratobasidium</td><td>655.37</td></tr><tr><td>Claviceps Maximensis</td><td>329.79</td></tr><tr><td>Fusarium Annulatum</td><td>449.98</td></tr><tr><td>Melampsora</td><td>699.52</td></tr><tr><td>Metschnikowia</td><td>109.36</td></tr><tr><td>Mucor Saturninus</td><td>391.17</td></tr><tr><td>Penicillium Chermesinum</td><td>275.81</td></tr><tr><td>Saccharomyces Cerevisiae</td><td>121.54</td></tr><tr><td>Sporopachydermia Quercuum</td><td>155.71</td></tr><tr><td>Tranzscheliella Williamsii</td><td>184.77</td></tr><tr><td>Xylariales</td><td>399.96</td></tr><tr><td rowspan="2">Protozoa</td><td>Phytophthora Sojae</td><td>792.65</td></tr><tr><td>Pythium Apiculatum</td><td>450.99</td></tr><tr><td rowspan="7">Mammalian</td><td>Bubalus Bubalis</td><td>28768.00</td></tr><tr><td>Camelus Dromedarius</td><td>19757.02</td></tr><tr><td>Human</td><td>31372.10</td></tr><tr><td>Macaca Assamensis</td><td>27593.76</td></tr><tr><td>Macaca Nigra</td><td>28217.13</td></tr><tr><td>Mus Musculus</td><td>26545.98</td></tr><tr><td>Peromyscus Californicus</td><td>24677.56</td></tr></table>

(Continued on next page)


(Continued from previous page)


<table><tr><td>Category</td><td>Species</td><td>Nucleotides (M)</td></tr><tr><td rowspan="10">Invertebrate</td><td>Brachionus Rubens</td><td>1327.37</td></tr><tr><td>Ceroptres Masudai</td><td>12.95</td></tr><tr><td>Cotesia Typhae</td><td>1866.62</td></tr><tr><td>Croniades Pieria</td><td>3889.85</td></tr><tr><td>Drosophila Athabasca</td><td>1221.16</td></tr><tr><td>Emesis Russula</td><td>4848.08</td></tr><tr><td>Hydra Oligactis</td><td>12597.75</td></tr><tr><td>Meganola Albula</td><td>3604.25</td></tr><tr><td>Oscheius</td><td>383.21</td></tr><tr><td>Rutpela Maculata</td><td>20213.33</td></tr><tr><td rowspan="5">Other Vertebrate</td><td>Anas Zonorhyncha</td><td>11697.08</td></tr><tr><td>Coregonus Clupeaformis</td><td>26824.02</td></tr><tr><td>Gnathonemus Longibarbis</td><td>7314.74</td></tr><tr><td>Myxocyprinus Asiaticus</td><td>23407.19</td></tr><tr><td>Rhipidura Dahli</td><td>10112.96</td></tr><tr><td rowspan="39">Bacteria</td><td>Aeromonas</td><td>47.33</td></tr><tr><td>Agrobacterium</td><td>97.22</td></tr><tr><td>Alcaligenaceae Bacterium</td><td>20.88</td></tr><tr><td>Aliivibrio</td><td>46.48</td></tr><tr><td>Alphaproteobacteria Bacterium</td><td>14.22</td></tr><tr><td>Amycolatopsis Antarctica</td><td>63.43</td></tr><tr><td>Anaerostipes Faecis</td><td>32.00</td></tr><tr><td>Arthrobacter</td><td>36.27</td></tr><tr><td>Atopobium</td><td>28.63</td></tr><tr><td>Bacillus Bc15</td><td>57.34</td></tr><tr><td>Bacillus Bs3 2021</td><td>43.51</td></tr><tr><td>Bacterium</td><td>7.54</td></tr><tr><td>Bacteroidetes Bacterium Qs</td><td>8.99</td></tr><tr><td>Breoghania Corrubedonensis</td><td>53.32</td></tr><tr><td>Caldicoprobacter Oshimai</td><td>27.25</td></tr><tr><td>Candidatus Cryptobacteroides Excrementipullorum</td><td>27.63</td></tr><tr><td>Candidatus Dadabacteria Bacterium Rbg Combo</td><td>11.49</td></tr><tr><td>Candidatus Dwaynia Gallinarum</td><td>16.82</td></tr><tr><td>Candidatus Falkowbacteria Bacterium</td><td>13.88</td></tr><tr><td>Candidatus Geothermincola Secundus</td><td>24.76</td></tr><tr><td>Candidatus Gottesmanbacteria Bacterium</td><td>11.08</td></tr><tr><td>Candidatus Nomurabacteria Bacterium Full</td><td>6.29</td></tr><tr><td>Candidatus Portnoybacteria Bacterium Big Fil Rev</td><td>8.17</td></tr><tr><td>Candidatus Regiella Insecticola</td><td>20.62</td></tr><tr><td>Candidatus Roizmanbacteria Bacterium Combo All</td><td>11.13</td></tr><tr><td>Candidatus Rokubacteria Bacterium</td><td>22.06</td></tr><tr><td>Candidatus Saccharibacteria Bacterium</td><td>6.55</td></tr><tr><td>Candidatus Staskawiczbacteria Bacterium Full</td><td>6.79</td></tr><tr><td>Christensenella</td><td>18.75</td></tr><tr><td>Clostridiaceae Bacterium</td><td>29.62</td></tr><tr><td>Clostridiales Bacterium</td><td>16.59</td></tr><tr><td>Clostridium Cag 505</td><td>21.26</td></tr><tr><td>Clostridium Mcc328</td><td>36.43</td></tr><tr><td>Clostridium Nexile</td><td>38.43</td></tr><tr><td>Clostridium Uba3521</td><td>25.99</td></tr><tr><td>Collinsella Urealyticum</td><td>19.45</td></tr><tr><td>Coprobacillus Cateniformis</td><td>38.38</td></tr><tr><td>Cyanobium</td><td>40.33</td></tr><tr><td>Dehalococcoidia Bacterium</td><td>17.59</td></tr></table>

(Continued on next page)


(Continued from previous page)


<table><tr><td>Category</td><td>Species</td><td>Nucleotides (M)</td></tr><tr><td rowspan="55">Bacteria</td><td>Enterobacteriaceae Bacterium</td><td>41.46</td></tr><tr><td>Evsepia Gabavorous</td><td>24.94</td></tr><tr><td>Firmicutes Bacterium</td><td>36.66</td></tr><tr><td>Fulvivirga</td><td>65.24</td></tr><tr><td>Jeongeupia Chitinilytica</td><td>39.11</td></tr><tr><td>Legionella Endosymbiont Of Polyplax Serrata</td><td>5.30</td></tr><tr><td>Listeria Ilorinensis</td><td>30.31</td></tr><tr><td>Maribacter Cobaltidurans</td><td>46.40</td></tr><tr><td>Marinomonas</td><td>37.73</td></tr><tr><td>Mesorhizobium</td><td>65.15</td></tr><tr><td>Methyloceanibacter Caenitepidi</td><td>34.25</td></tr><tr><td>Microvirga</td><td>68.63</td></tr><tr><td>Mycolicibacter Engbaekii</td><td>45.21</td></tr><tr><td>Novosphingobium</td><td>46.18</td></tr><tr><td>Omnitrophica Wor Bacterium Rbg</td><td>12.52</td></tr><tr><td>Pantoea</td><td>43.14</td></tr><tr><td>Paraburkholderia Edwinii</td><td>82.99</td></tr><tr><td>Parerythrobacter Lutipelagi</td><td>30.98</td></tr><tr><td>Paulownia Witches Phytoplasma</td><td>8.92</td></tr><tr><td>Polaromonas Eurypsychrophila</td><td>41.61</td></tr><tr><td>Prevotella Ag 487 50 53</td><td>29.63</td></tr><tr><td>Prevotella Uba3619</td><td>31.72</td></tr><tr><td>Prevotella Uba634</td><td>18.51</td></tr><tr><td>Prochlorococcus Ag-321-I09</td><td>3.29</td></tr><tr><td>Prochlorococcus Ag-363-B18</td><td>15.54</td></tr><tr><td>Prochlorococcus Ag-402-L19</td><td>11.17</td></tr><tr><td>Prochlorococcus Scb243 498N4</td><td>14.12</td></tr><tr><td>Providencia</td><td>41.89</td></tr><tr><td>Pseudomonas 35 E 8</td><td>63.56</td></tr><tr><td>Pseudomonas Bigb0408</td><td>59.52</td></tr><tr><td>Pseudomonas P867</td><td>62.01</td></tr><tr><td>Pseudomonas Promysalinigenes</td><td>50.47</td></tr><tr><td>Roseobacter</td><td>44.14</td></tr><tr><td>Salinicola Peritrichatus</td><td>46.19</td></tr><tr><td>Salmonella S096 02912</td><td>48.09</td></tr><tr><td>Salmonella Zj-F75</td><td>47.87</td></tr><tr><td>Sinorhizobium</td><td>65.53</td></tr><tr><td>Sodalis Ligni</td><td>63.85</td></tr><tr><td>Sphaerochaeta</td><td>28.61</td></tr><tr><td>Sphingobacterium</td><td>36.55</td></tr><tr><td>Sphingomonas Carotinifaciens</td><td>37.53</td></tr><tr><td>Sphingomonas Mesophila</td><td>22.91</td></tr><tr><td>Sporosarcina Jiandibaonis</td><td>36.30</td></tr><tr><td>Sporosarcina Ureilytica</td><td>34.37</td></tr><tr><td>Staphylococcus Gdq20D1P</td><td>28.50</td></tr><tr><td>Staphylococcus M0911</td><td>24.38</td></tr><tr><td>Streptococcus</td><td>22.18</td></tr><tr><td>Streptomyces 8401</td><td>88.39</td></tr><tr><td>Streptomyces Di166</td><td>88.71</td></tr><tr><td>Streptomyces Durbertensis</td><td>59.24</td></tr><tr><td>Streptomyces Neau-Yj-81</td><td>118.84</td></tr><tr><td>Streptomyces Rk74B</td><td>87.36</td></tr><tr><td>Thermopetrobacter</td><td>26.06</td></tr><tr><td>Uncultured Kushneria</td><td>35.31</td></tr><tr><td>Uncultured Phascolarctobacterium</td><td>17.95</td></tr></table>

(Continued on next page)


(Continued from previous page)


<table><tr><td>Category</td><td>Species</td><td>Nucleotides (M)</td></tr><tr><td rowspan="6">Bacteria</td><td>Uncultured Proteus</td><td>35.66</td></tr><tr><td>Verrucomicrobiales Bacterium</td><td>3.15</td></tr><tr><td>Vibrio</td><td>41.47</td></tr><tr><td>Victivallis Lenta</td><td>55.45</td></tr><tr><td>Virgibacillus Salexigens</td><td>44.18</td></tr><tr><td>Xanthomonadales Bacterium</td><td>37.47</td></tr></table>

Table 11: Details statistics of the multi-species genome dataset for pre-training.

# B.2 GENOME UNDERSTANDING EVALUATION (GUE & GUE+)

The proposed benchmark Genome Understanding Evaluation (GUE) contains 36 datasets of 9 biological important genome analysis tasks for various different species. To comprehensively evaluate the genome foundation models in modeling variable-length sequences, we select tasks with input lengths ranging from 70 to 10000. Table 12 presents the detailed statistics of each evaluation dataset. The following tasks are included in the GUE benchmark.

Promoter detection (Human) focuses on identifying (proximal) promoter regions, crucial sequences in the human genome responsible for instigating transcription. As many primary regulatory elements are located in this region, accurately detecting these sites is instrumental in advancing our grasp of gene regulation mechanisms and pinpointing the genomic underpinnings of numerous diseases. The dataset is divided twofold, TATA and non-TATA, based on whether a TATA box motif is present in the sequence. We extract  $-249 + 50$  bp around the transcription start site (TSS) from TATA and non-TATA promoters downloaded from Eukaryotic Promoter Database (EPDnew) (Dreos et al., 2013) and use it as our promoter class. Meanwhile, we construct the non-promoter class with equal-sized randomly selected sequences outside of promoter regions but with TATA motif (TATA non-promoters) or randomly substituted sequences (non-TATA, non-promoters). We also combine the TATA and non-TATA datasets to obtain a combined dataset named all.

Core promoter detection (Human) is similar to proximal promoter detection with a focus on predicting the core promoter region only, the central region closest to the TSS and start codon. A much shorter context window (center  $-34 + 35$  bp around TSS) is provided, making this a more challenging task than proximal promoter prediction.

Transcription factor binding site prediction (Human) predicts binding sites of transcription factors (TF), the key proteins that regulate gene expression in the human genome. Their accurate prediction is key to deciphering complex genetic interactions and identifying potential targets for gene therapies. We accessed the legacy 690 ENCODE ChIP-seq experiments (Consortium et al., 2012) via the UCSC genome browser, which encompasses 161 TF binding profiles in 91 human cell lines. We extracted a 101-bp region around the center of each peak as TFBS class and nonoverlapping sequences with the same length and GC content as non-TFBS class. Finally, we randomly select 5 datasets out of a subset of 690 that we curated by heuristically filtering out tasks that are either too trivial (e.g., over 0.95 F1) or too challenging (e.g., less than 0.50 F1) for existing language models.

Splice site prediction (Human) predicts splice donor and acceptor sites, which are the exact locations in the human genome where alternative splicing occurs. This prediction is crucial to understanding protein diversity and the implications of aberrant splicing in genetic disorders. The dataset (Wang et al., 2019) consists of 400-bp-long sequences extracted from Ensembl GRCh38 human reference genome. As suggested by Ji et al. (2021), existing models can achieve almost perfect performance on the original dataset, containing 10,000 splice donors, acceptors, and non-splice site sequences, which is overly optimistic on detecting non-canonical sites in reality. As such, we reconstruct the dataset by iteratively adding adversarial examples (unseen false positive predictions in hold-out set) in order to make this task more challenging.

<table><tr><td>Task</td><td>Metric</td><td>Datasets</td><td>Train / Dev / Test</td></tr><tr><td rowspan="3">Core Promoter Detection</td><td rowspan="3">mcc</td><td>tata</td><td>4904 / 613 / 613</td></tr><tr><td>notata</td><td>42452 / 5307 / 5307</td></tr><tr><td>all</td><td>47356 / 5920 / 5920</td></tr><tr><td rowspan="3">Promoter Detection</td><td rowspan="3">mcc</td><td>tata</td><td>4904 / 613 / 613</td></tr><tr><td>notata</td><td>42452 / 5307 / 5307</td></tr><tr><td>all</td><td>47356 / 5920 / 5920</td></tr><tr><td rowspan="5">Transcription Factor Prediction (Human)</td><td rowspan="5">mcc</td><td>wgEncodeEH000552</td><td>32378 / 1000 / 1000</td></tr><tr><td>wgEncodeEH000606</td><td>30672 / 1000 / 1000</td></tr><tr><td>wgEncodeEH001546</td><td>19000 / 1000 / 1000</td></tr><tr><td>wgEncodeEH001776</td><td>27294 / 1000 / 1000</td></tr><tr><td>wgEncodeEH002829</td><td>19000 / 1000 / 1000</td></tr><tr><td>Splice Site Prediction</td><td>mcc</td><td>reconstructed</td><td>36496 / 4562 / 4562</td></tr><tr><td rowspan="5">Transcription Factor prediction (Mouse)</td><td rowspan="5">mcc</td><td>Ch12Nrf2Iggrab</td><td>6478 / 810 / 810</td></tr><tr><td>Ch12Znf384hpa004051Iggrab</td><td>53952 / 6745 / 6745</td></tr><tr><td>MelJundIggrab</td><td>2620 / 328 / 328</td></tr><tr><td>MelMafkDm2p5dStd</td><td>1904 / 239 / 239</td></tr><tr><td>MelNelfeIggrab</td><td>15064 / 1883 / 1883</td></tr><tr><td rowspan="10">Epigenetic Marks Prediction</td><td rowspan="10">mcc</td><td>H3</td><td>11971 / 1497 / 1497</td></tr><tr><td>H3K14ac</td><td>26438 / 3305 / 3305</td></tr><tr><td>H3K36me3</td><td>27904 / 3488 / 3488</td></tr><tr><td>H3K4me1</td><td>25341 / 3168 / 3168</td></tr><tr><td>H3K4me2</td><td>24545 / 3069 / 3069</td></tr><tr><td>H3K4me3</td><td>29439 / 3680 / 3680</td></tr><tr><td>H3K79me3</td><td>23069 / 2884 / 2884</td></tr><tr><td>H3K9ac</td><td>22224 / 2779 / 2779</td></tr><tr><td>H4</td><td>11679 / 1461 / 1461</td></tr><tr><td>H4ac</td><td>27275 / 3410 / 3410</td></tr><tr><td>Covid Variant Classification</td><td>f1</td><td>Covid</td><td>77669 / 7000 / 7000</td></tr><tr><td rowspan="6">Enhancer Promoter Interaction</td><td rowspan="6">mcc</td><td>GM12878</td><td>10000 / 2000 / 2000</td></tr><tr><td>HeLa-S3</td><td>10000 / 2000 / 2000</td></tr><tr><td>HUVEC</td><td>10000 / 2000 / 2000</td></tr><tr><td>IMR90</td><td>10000 / 2000 / 2000</td></tr><tr><td>K562</td><td>10000 / 2000 / 2000</td></tr><tr><td>NHEK</td><td>10000 / 2000 / 2000</td></tr><tr><td rowspan="2">Species Classification</td><td rowspan="2">mcc</td><td>fungi</td><td>8000 / 1000 / 1000</td></tr><tr><td>virus</td><td>4000 / 500 / 500</td></tr></table>

Table 12: Statistics of tasks in the GUE benchmark, including the name and the number of training, validation, and test samples in each dataset.

Enhancer promoter interaction (Human) identifies the interactions between enhancers and promoters, integral to regulating gene expression in the human genome. We formulate it as a sequence-pair binary classification problem.

Species Classification (Virus & Fungi) classifies different species based on genome segments. We construct the datasets respectively from the virus and fungi reference genome achieved from GenBank (Benson et al., 2012).

Transcription factor binding site prediction (Mouse) predicts the binding site of transcription factors on mouse genomes. Similar to human binding site data, we obtain mouse ENCODE ChIP-seq data (Stamatoyannopoulos et al., 2012), which is the largest available collection on the UCSC genome browser  $(n = 78)$ . This time, the negative examples are created using dinucleotide shuffling while preserving relative frequencies, while all other settings stay the same as the human TFBS prediction dataset. We also randomly select 5 datasets out of the 78 datasets using the same process described above.

Epigenetic marks prediction (Yeast) predicts epigenetic marks in yeast, modifications on the genetic material that influence gene expression without altering the DNA sequence. Precise prediction of these marks aids in elucidating the role of epigenetics in yeast. We download the 10 datasets from http://www.jaist.ac.jp/~tran/nucleosome/members.htm and randomly split each dataset into training, validation, and test sets with a ratio of 8:1:1.

Covid variant prediction (Virus) aims to predict the variant type of the SARS-CoV_2 virus based on 1000-length genome sequences. We download the genomes from the EpiCoV database (Khare et al., 2021) of the Global Initiative on Sharing Avian Influenza Data (GISAID). We consider 9 types of SARS-CoV_2 variants, including Alpha, Beta, Delta, Eta, Gamma, Iota, Kappa, Lambda and Zeta.